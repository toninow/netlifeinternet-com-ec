/*!
 * jQuery Stick to Me plugin
 *
 * @author: Guilherme Assemany
 * @version: 1.0
 * @requires jQuery 1.6.1 or later
 *
 */
!function(e){function t(){e(".stick_container").fadeOut((function(){e(this).remove()})),e(".stick_block_layer").fadeOut((function(){e(this).remove()})),e.removeData(document.body,"stick_var")}e.stickToMe=function(o){var n=e.extend({},{layer:"",fadespeed:400,trigger:["top"],maxtime:0,mintime:0,delay:0,interval:0,maxamount:0,cookie:!1,bgclickclose:!0,escclose:!0,onleave:function(e){},onenter:!1,disableleftscroll:!0},o);e(n.layer).hide();var i,c=(new Date).getTime(),a=e(window).height(),d=e(window).width(),s=!1,r=0,l=0,u=!0,m=0;if(/Chrome/.test(navigator.userAgent)){var f=!0;e(document).width()>d&&1==n.disableleftscroll&&(u=!1)}var g=parseFloat(e(n.layer).css("height")),v=parseFloat(e(n.layer).css("width")),p={backgroundcss:{"z-index":"1000",display:"none"},boxcss:{"z-index":"1000",position:"fixed",left:"50%",top:"50%","min-height":"auto",width:v+"px","margin-left":-v/2+"px","margin-top":-g/2+"px"}};function b(){s=!1,e(document).bind("mousemove.bindoffset",(function(t){s&&(e(document).bind("mouseleave",(function(e){setTimeout((function(){k(e)}),n.delay)})),e(document).unbind("mousemove.bindoffset")),s=!0}))}function k(o){var s=document.documentElement?document.documentElement.scrollTop:document.body.scrollTop,g=document.documentElement?document.documentElement.scrollLeft:document.body.scrollLeft;if(s=e(document).scrollTop()>s?e(document).scrollTop():s,g=e(document).scrollLeft()>g?e(document).scrollLeft():g,-1==Math.round(o.pageX)||-1==Math.round(o.pageY)||-3==o.pageX||-3==o.pageY)var v=-m+s,p=i-g;else v=-o.pageY+s,p=o.pageX-g;var k,h=a/d*p-a;if(k=v>=-a/d*p?v>=h?"top":"right":v>=h?"left":"bottom",!(/Firefox[\/\s](\d+\.\d+)/.test(navigator.userAgent)&&v<0&&v>-a&&p>0&&p<d)){if(-1!=e.inArray(k,n.trigger)||-1!=e.inArray("all",n.trigger)){var y=(new Date).getTime();if(y-c>=n.mintime&&(y-c<=n.maxtime||0==n.maxtime)&&(r<n.maxamount||0==n.maxamount)&&(y-l>=n.interval||0==n.interval)&&u){var w=function(e){for(var t=e+"=",o=document.cookie.split(";"),n=0;n<o.length;n++){for(var i=o[n];" "==i.charAt(0);)i=i.substring(1);if(-1!=i.indexOf(t))return i.substring(t.length,i.length)}return 0}("ck_stick_visit");(0==n.cookie||1==n.cookie&&(w<n.maxamount||0==n.maxamount))&&(n.onleave.call(this,k),""==n.layer||n.onenter?n.onenter&&n.onenter():1!=e.data(document.body,"stick_var")&&(e.data(document.body,"stick_var",1),e('<div class="stick_block_layer"></div>').appendTo("body").css(n.backgroundcss).fadeIn(n.fadespeed),e('<div class="stick_container"></div>').appendTo("body"),e(n.layer).clone().show().css(n.boxcss).appendTo(".stick_container"),n.bgclickclose&&e(".stick_block_layer").click((function(){t()})),n.escclose&&e("body").keyup((function(e){27==e.which&&t()}))),r++,1==n.cookie&&(w++,document.cookie="ck_stick_visit="+w+"; path=/"),l=(new Date).getTime())}}f&&(e(document).unbind("mouseleave"),b())}}e.extend(!0,n,p),e(document).bind("mousemove",(function(e){i=e.pageX,m=e.pageY})),e(document).bind("mouseleave",(function(e){setTimeout((function(){k(e)}),n.delay)})),f&&(e(document).unbind("mouseleave"),b()),e(window).resize((function(t){a=e(window).height(),d=e(window).width()}))},e.stick_close=function(){t()}}(jQuery);
